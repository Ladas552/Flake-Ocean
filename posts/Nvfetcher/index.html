<!doctypehtml><html lang=en-US><meta charset=UTF-8><meta content=width=device-width,initial-scale=1.0 name=viewport><meta content=Norgolith name=generator><meta content="Inputs outside of flakes"name=description><meta content=[ladas552] name=author><meta content="inputs , un-flake"name=keywords><meta content="Nvfetcher - Nix"property=og:title><meta content=article property=og:type><meta content=https://ladas552.me/Flake-Ocean/posts/Nvfetcher/ property=og:url><meta content="Inputs outside of flakes"property=og:description><meta content=Nix property=og:site_name><meta content=en-US property=og:locale><link href=https://ladas552.me/Flake-Ocean/posts/Nvfetcher/ rel=canonical><meta content="index, follow"name=robots><link href=https://prismjs.catppuccin.com/mocha.css rel=stylesheet><script defer src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js></script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js></script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js></script><script>document.addEventListener(`alpine:init`,()=>{let d=`dark`,a=`sidebarCollapsed`,b=`theme`,c=`light`;Alpine.data(`menu`,()=>({currentPage:window.location.pathname,openMobile:!1,sidebarCollapsed:localStorage.getItem(a)===`true`,toggleMobile(){this.openMobile=!this.openMobile},toggleSidebar(){this.sidebarCollapsed=!this.sidebarCollapsed;localStorage.setItem(a,this.sidebarCollapsed)}}));Alpine.data(b,()=>({current:c,init(){const a=localStorage.getItem(b);if(a){this.current=a}else if(window.matchMedia(`(prefers-color-scheme: dark)`).matches){this.current=d};localStorage.setItem(b,this.current);if(this.current===d){document.documentElement.classList.add(d)}},toggle(a){const e=a.clientX;const f=a.clientY;document.documentElement.style.setProperty(`--x`,`${e}px`);document.documentElement.style.setProperty(`--y`,`${f}px`);if(!document.startViewTransition){this.current=this.current===d?c:d;document.documentElement.classList.toggle(d,this.current===d);localStorage.setItem(b,this.current);return};const g=document.startViewTransition(()=>{this.current=this.current===d?c:d;document.documentElement.classList.toggle(d,this.current===d);localStorage.setItem(b,this.current)})}}))})</script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.9.0/mermaid.min.js></script><link href=https://ladas552.me/Flake-Ocean/assets/css/styles.min.css rel=stylesheet><link href=/assets/favicon.png rel=icon><title>Nvfetcher - Nix</title><body x-data=menu><header><nav class="flex items-center h-full px-4"><button aria-label="Toggle Menu"class="menu-btn md:hidden"@click=toggleMobile><svg viewbox="0 0 24 24"fill=none stroke=currentColor x-show=!openMobile><path d="M4 6h16M4 12h16M4 18h16"stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg> <svg viewbox="0 0 24 24"fill=none stroke=currentColor x-show=openMobile><path d="M6 18L18 6M6 6l12 12"stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></button><a class=header-title href=https://ladas552.me/Flake-Ocean/>Nix</a><div class="hidden md:flex md:items-center md:gap-6 md:ml-8"><a :class="{ 'active-nav': currentPage.startsWith('/categories') }"class=nav-link href=https://ladas552.me/Flake-Ocean/categories>Tags</a></div><div x-data=theme><button :aria-label="current === 'dark' ? 'Switch to light mode' : 'Switch to dark mode'"@click=toggle($event) class=theme-toggle><svg viewbox="0 0 24 24"x-show="current === 'dark'"fill=none stroke=currentColor><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg> <svg viewbox="0 0 24 24"x-show="current === 'light'"fill=none stroke=currentColor><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></button></div></nav></header><div class=page-wrapper><aside :class="{ 'open': openMobile, 'collapsed': sidebarCollapsed }"class=sidebar><button :aria-label="sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'"class="sidebar-toggle hidden md:flex"@click=toggleSidebar><svg viewbox="0 0 24 24"fill=none stroke=currentColor x-show=!sidebarCollapsed><path d="M11 19l-7-7 7-7m8 14l-7-7 7-7"stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg> <svg viewbox="0 0 24 24"fill=none stroke=currentColor x-show=sidebarCollapsed><path d="M13 5l7 7-7 7M5 5l7 7-7 7"stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></button><nav><div class=nav-section><h3>Documentation</h3><a :class="{ 'active': currentPage === 'https://ladas552.me/Flake-Ocean/posts/Impermanence/' }"title="Guide for my impermanence setup"href=https://ladas552.me/Flake-Ocean/posts/Impermanence/>Impermanence on NixOS with ZFS and tmpfs</a><a :class="{ 'active': currentPage === 'https://ladas552.me/Flake-Ocean/posts/Nvfetcher/' }"title="Inputs outside of flakes"href=https://ladas552.me/Flake-Ocean/posts/Nvfetcher/>Nvfetcher</a></div></nav></aside><div :class="{ 'sidebar-collapsed': sidebarCollapsed }"class=content-wrapper><main class=content><h1>Nvfetcher</h1><p class=post-meta><time datetime=2026-02-08>February 8, 2026</time> <span class=tag-spacing> Tags: <a href=https://ladas552.me/Flake-Ocean/categories/inputs>inputs</a>, <a href=https://ladas552.me/Flake-Ocean/categories/un-flake>un-flake</a> </span><h2 id=What-is-Nvfetcher?>What is Nvfetcher?</h2><p>It's a Haskell program that takes values from a toml file and generates fetched inputs that I can use in my config. Without having to manually update the Hash, but still remain locked on per commit basis. Same as <code>flake.lock</code>.<h2 id=Why-don't-you-just-use-flakes?>Why don't you just use flakes?</h2><p>Even tho I love flakes, I can acknowledge that they have issues. Namely, in the context of inputs:<ul><li>Unchanged <code>follows</code> for inputs will download unnecessary code, that in context of something big as nixpkgs can cost 40MiB of download data per input and per <code>nix flake update</code>;</ul><ul><li>You can't define inputs to download stuff only when needed. The <code>ghostty-shaders</code> input will be downloaded during update on both Desktop, a server and even on the phone. Can't decide whether it's needed there or not;</ul><ul><li>Inputs are hella slow. No, I am not benchmarking it, just feels like this.</ul><p>In this case, Nvfetcher comes in handy. Fetchers work only if you import the input.<h3 id=What-about-Npins?>What about Npins?</h3><p>I don't like using cli interface to generate fetches. Also It has problems with AppImages.<h2 id=How-to-use-Nvfetcher?>How to use Nvfetcher?</h2><p>Go read the docs in the <a href=https://github.com/berberman/nvfetcher>project's repository</a>.<p>TLDR: define source and fetcher in toml file, 2 files are generated, you import nix file with <code>pkgs.callPackage</code>, or read json file directly with <code>builtins.fromJSON</code> and <code>builtins.readFile</code> if <code>pkgs</code> isn't available on the scope, or you want to import a fetched nix file inside of your nix module.<p>For example, it works wonders for fetching neovim plugins.<pre><code class=language-nix># nvfetcher pins
sources = pkgs.callPackage "${self}/_sources/generated.nix" { };
heirline-components = pkgs.vimUtils.buildVimPlugin {
  name = "heirline-components.nvim";
  doCheck = false;
  src = sources.heirline-components.src;
};
</code></pre><p>Then I can call <code>heirline-components</code> in a package list to install it. I use <code>self</code> to avoid using relative paths, and keep my config modules independent of location.<p>And here is a custom example of using the json file directly.<pre><code class=language-nix>sourcesJson = builtins.fromJSON (builtins.readFile ./_sources/generated.json);

modules = builtins.mapAttrs (
  name: value:
    let
      src = fetchTarball {
      url = "${value.src.url}/archive/${value.src.rev}.tar.gz";
        sha256 = value.src.sha256;
      };
    in
  value // { inherit src; }
) sourcesJson;
</code></pre><p>This snippet is in my <code>flake.nix</code>. I use it to create a <code>specialArgs</code> in my config called <code>modules</code>. In any file I can add <code>modules</code> to the top and import some file from Nvfetcher inputs.<p>Demonstration of one of my hosts that is NixOS-WSL based.<pre><code class=language-nix>{ modules, ... }:
{
 flake.modules.nixos.NixwsL =
 { config, ... }:
 {
   imports = [
     "${modules.nixos-wsl.src}/modules"
   ];
   networking.hostName = "NixwsL";
   wsl = {
     enable = true;
     # if you are wondering what these config options are
     # it will be explained in another article
     defaultUser = "${config.custom.meta.user}";
     startMenuLaunchers = true;
     tarball.configPath = "${config.custom.meta.self}";
     usbip.enable = true;
     useWindowsDriver = true;
   };

   system.stateVersion = "24.05"; # Do you like bunnies?

   nixpkgs.hostPlatform = "x86_64-linux";
 };
}
</code></pre><p><code>"${modules.nixos-wsl.src}/modules"</code> is equivalent to importing <code>inputs.nixos-wsl.nixosModules.default</code>. But it will be fetched only if I use NixOS-WSL, and not on other hosts.<h2 id=Roll-the-credits>Roll the credits</h2><p>Okay, that's about all I know and use Nvfetcher for, as always, Thanks goes to:<ul><li><a href=https://github.com/berberman>@berberman</a> - for creating and maintaining such a nice program;</ul><ul><li><a href=https://github.com/iynaix>@iynaix</a> - for information that Nvfetcher exists;</ul><ul><li><a href=https://git.gay/sunworms>@sunworms</a> - for sharing a way to parse json file directly;</ul><ul><li><strong>You</strong> - for reading to the end, have a nice day and reproducible builds.</ul></main><footer><div><p>ladas552 Â© 2026 | Licensed under GPLv3<p><a href=https://github.com/Ladas552/Flake-Ocean rel=noopener target=_blank>GitHub</a></div></footer></div></div>